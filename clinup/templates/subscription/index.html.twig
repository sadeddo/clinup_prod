{# templates/subscription/subscription_needed.html.twig #}
{% extends 'base1.html.twig' %}

{% block title %}Abonnement Nécessaire{% endblock %}

{% block body %}
    <style>
        .pricing-table {
            margin: 50px auto;
        }
        .pricing-card {
            border: 1px solid #ddd;
            margin-bottom: 20px;
        }
        .pricing-card .card-header {
            background-color: #f8f9fa;
            font-size: 1.5rem;
            font-weight: bold;
        }
        .pricing-card .card-body {
            padding: 1.5rem;
        }
        .pricing-card .plan-price {
            font-size: 1.25rem;
            font-weight: bold;
            color: #FF385C !important;
            margin-bottom: 15px;
        }
        .pricing-card .plan-action {
            margin: 20px 0;
        }
    </style>
    <main class="main-container">
        <div class="container" style="width:95%;height: auto;">
            <div class="row reservation">
                <div class="col-auto me-auto">
                    <strong class="card-title" style="font-weight: bold;font-size:1.6rem;">Abonnement</strong>
                </div>            
                {% for messages in app.flashes('success') %}
                    <div class="alert alert-success">{{ messages }}</div>
                {% endfor %}
                {% for messages in app.flashes('error') %}
                    <div class="alert alert-danger">{{ messages }}</div>
                {% endfor %}
            </div><br>
            <div class="pricing-table">
                {% if subscription and subscription.status == 'active' %}
                    <div class="row">
                        <div class="col-md-6" style="margin: auto;">
                            <div class="card pricing-card">
                                <div class="card-header text-center">
                                    {% if subscription.type =='log2' %}
                                        2 logements
                                    {% elseif subscription.type =='log3' %}
                                        3+ logements
                                    {% endif %}
                                </div>
                                <div class="card-body text-center">
                                    <div class="plan-price">
                                        {% if subscription.type =='log2' %}
                                            9,98€ / mois
                                        {% elseif subscription.type =='log3' %}
                                            11,97€ / mois
                                        {% endif %}
                                    </div>
                                    <ul class="list-unstyled">
                                        <p><strong>Date de début:</strong></p>
                                        <p>{{ subscription.dtStart|date('j M. Y') }}</p>
                                    </ul>
                                    
                                    <!-- Bouton vers portail client -->
                                    <a href="https://billing.stripe.com/p/login/6oUdR90F34hSgOT6ibcZa00" 
                                       target="_blank" 
                                       class="btn btn-primary plan-action">
                                        Gérer mon abonnement
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                {% else %}
                    <div class="row">
                        <div class="col-md-6" style="margin: auto;">
                            <div class="card pricing-card">
                                <div class="card-header text-center">
                                    Offre disponible
                                </div>
                                <div class="card-body text-center">
                                    <div class="plan-price">9,98€ / mois</div>
                                    <ul class="list-unstyled">
                                        <li>2 logements inclus</li>
                                        <li>Support 24/7</li>
                                        <li>Planification automatique</li>
                                    </ul>
                                    <!-- Bouton vers Payment Link -->
                                    <a href="https://buy.stripe.com/5kQaEXevT01CfKPgWPcZa04" 
                                       target="_blank" 
                                       class="btn btn-success plan-action">
                                        Souscrire un abonnement
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </main>
{% endblock %}
